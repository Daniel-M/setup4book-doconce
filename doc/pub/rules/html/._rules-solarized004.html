<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Directory and file structure">
<meta name="keywords" content="figure directory,movie directory,video directory,source code directory,nickname,newcommands,chapter organization,chapter files,figure directory,movie directory,video directory,source code directory,assembly (chapters to book),links to fig/src directories,IPython notebooks,notebooks,Jupyter notebooks,RunestoneInteractive books,sphinx,cross-referencing,generalized references,slides,study guides,IPython notebooks,notebooks,Jupyter notebooks,private repos,mirroring repos,solutions to exercises,admonitions,interactive code,exercises in DocOnce,quiz,multiple-choice questions,video in DocOnce,embedded video in DocOnce,movie in DocOnce">

<title>Directory and file structure</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


<script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css">
<script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
});
</script>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Directory structure',
               1,
               'setup:rules:dir_struct',
               'setup:rules:dir_struct'),
              ('Principles and conventions',
               1,
               'setup:rules:conv',
               'setup:rules:conv'),
              ('Mathematical notation and newcommands',
               2,
               'setup:rules:conv:newcommands',
               'setup:rules:conv:newcommands'),
              ('Label conventions',
               2,
               'setup:rules:conv:labels',
               'setup:rules:conv:labels'),
              ('Programming style', 2, None, '___sec4'),
              ('Degree of modularization', 2, None, '___sec5'),
              ('Student guide (slides) style', 2, None, '___sec6'),
              ('Style in exercises, problems, and projects',
               2,
               None,
               '___sec7'),
              ('Assembling different pieces to a book',
               1,
               'setup:rules:book_assembly',
               'setup:rules:book_assembly'),
              ('Organization of a chapter',
               2,
               'setup:rules:book_assembly:org',
               'setup:rules:book_assembly:org'),
              ('Figures and source code', 2, None, '___sec10'),
              ('Assembly of chapters to a book', 2, None, '___sec11'),
              ('Tools', 1, None, '___sec12'),
              ('Making a new chapter', 2, None, '___sec13'),
              ('Compiling the chapter to LaTeX and PDF', 2, None, '___sec14'),
              ('Cleaning Files', 3, None, '___sec15'),
              ('Automatic spell checking', 2, None, '___sec16'),
              ('Compiling the chapter to HTML', 2, None, '___sec17'),
              ('Compiling the chapter to a notebook', 2, None, '___sec18'),
              ('About figures when publishing HTML', 2, None, '___sec19'),
              ('Compiling the book', 2, None, '___sec20'),
              ('HTML/Sphinx versions of the book', 3, None, '___sec21'),
              ('Cross-referencing across chapters (or books)',
               1,
               None,
               '___sec22'),
              ('Study guides and slides',
               1,
               'setup:rules:slides',
               'setup:rules:slides'),
              ('Slide directory', 2, None, '___sec24'),
              ('Generating slides from running text', 2, None, '___sec25'),
              ('Slides as IPython/Jupyter notebooks', 2, None, '___sec26'),
              ('Compiling slides', 2, None, '___sec27'),
              ('IPython/Jupyter notebooks', 2, None, '___sec28'),
              ('Writing in private repository while publishing in public',
               1,
               None,
               '___sec29'),
              ('Book versions with and without solutions to exercises',
               1,
               None,
               '___sec30'),
              ('Special features for teaching material', 1, None, '___sec31'),
              ('Admonitions', 2, None, '___sec32'),
              ('Simple box', 2, None, '___sec33'),
              ('Embedded interactive code', 2, None, '___sec34'),
              ('The `pyoptpro` code environment', 3, None, '___sec35'),
              ('The `pyscpro` code environment', 3, None, '___sec36'),
              ('Exercises', 2, None, '___sec37'),
              ('Quote', 2, None, '___sec38'),
              ('Quiz', 2, None, '___sec39'),
              ('What about a video lecture?', 2, None, '___sec40'),
              ('References', 1, None, '___sec41')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<a name="part0004"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._rules-solarized003.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._rules-solarized005.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="___sec12">Tools </h1>

<p>
You can start a new, future, potential book project by simply copying
the directory structure of the <a href="https://github.com/hplgit/setup4book-doconce" target="_self">setup4book-doconce</a> repository on GitHub. Then you can follow
the instructions below to start writing and adapting the structure to
your project's needs.

<h2 id="___sec13">Making a new chapter </h2>

<p>
Under <code>doc/src/chapters</code>
you find the chapters in this &quot;sample book&quot; as well as a script
<code>doc/chapters/mkdir.sh</code> that creates a new directory for you with the
typical files needed for a new chapter. You can either edit existing
chapters, or make a brand new empty chapter by running

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">Terminal&gt; sh mkdir.sh mychap
</pre></div>
<p>
This command makes
a directory <code>mychap</code> for a new chapter with nickname <code>mychap</code>.
Files from the <code>template</code> directory are used to populate <code>mychap</code>. You get
an empty <code>mychap.do.txt</code> where the text is supposed to go, or this file
can just include a series of smaller <code>.do.txt</code> files, and you get the
wrapper file <code>main_mychap.do.txt</code> such that you can compile this chapter
as a stand-alone document. You also get <code>make.sh</code> which calls <code>../make.sh</code>
with the chapter main document (<code>main_mychap</code>) as argument. Optional
arguments for running <code>doconce format pdflatex</code> can be given to
<code>../make.sh</code> in <code>make.sh</code> if needed (e.g., <code>--encoding=utf8</code>).

<h2 id="___sec14">Compiling the chapter to LaTeX and PDF </h2>

<p>
To make a stand-alone document of a chapter, by compiling to LaTeX and PDF,
we propose the convention to have a <code>make.sh</code> in each chapter directory.
This <code>make.sh</code> can in most cases just call up a common <code>../make.sh</code>
script,

<p>

<!-- code=bash (!bc shpro) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">bash -x ../make.sh main_mychap
</pre></div>
<p>
or optionally with some command-line arguments,

<p>

<!-- code=bash (!bc shpro) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">bash -x ../make.sh main_mychap --encoding=utf-8
</pre></div>
<p>
The <code>doc/src/chapters/make.sh</code> script is quite general and may be edited
according to your layout preferences of the LaTeX documents.

<p>
The present <code>make.sh</code> script creates two PDF files: one for printing and
one for electronic viewing. The difference is that all URLs in the
version for printing appear as footnotes (and just hyperlinks with
a dark blue color in the electronic version). The two files are
named <code>mychap.pdf</code> and <code>mychap-4print.pdf</code>, respectively, and
copied to <code>doc/pub/mychap/pdf</code> for publishing.

<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b>Tip: use tinyurl.com for shortening long URLs.</b>
<p>
When compiling a document to LaTeX for <em>printing on paper</em> (<code>--device=paper</code>),
URLs in hyperlinks will appear as footnotes. Very long URLs may then exceed
the line width, or worse, extend beyond the physical paper size.
Replace such long URLs with short forms using <a href="http://tinyurl.com/" target="_self">tinyurl.com</a>.
I recommend tinyurl.com rather than competitors like <code>goo.gl</code> and <code>bit.ly</code>
because
if you have some URL <code>http://tinyurl.com/oul3xhn</code> you can easily
add more to the path, e.g., <code>http://tinyurl.com/oul3xhn/index.html</code>,
and this new URL works (<code>goo.gl</code> and <code>bit.ly</code> do not allow such extensions).

<p>
In particular, you can define the tinyurl.com URL as a Mako variable
(see <code>doc/mako_code.txt</code> for example) and use it as a quick and logical
name in the text for the URL and extend its path as appropriate. For example,
I always have a Mako variable for the URL of the repository directory for
the software associated with a chapter and can then easily add
<code>/myprog.py</code> to the variable to create a link to the file at GitHub.
Readers can then just click to read or download the file.
</div>


<p>
<b>Remark about LaTeX typesetting of computer code.</b>
The suggested <code>make.sh</code> file
applies the <code>--latex_code_style=</code> option to <code>doconce format</code>
for specifying the typesetting of blocks of computer code in LaTeX.
Originally, DocOnce applied the <code>ptex2tex</code> program to select such
typesetting, but the new method is more flexible and simpler in that
it gives cleaner LaTeX code. (With <code>ptex2tex</code> one would need a common
configuration file <code>.ptex2tex.cfg</code> in
<code>doc/chapters</code> to be copied by
<code>doc/chapters/make.sh</code> to the chapter directory prior to running
`ptex2tex.)

<h3 id="___sec15">Cleaning Files </h3>

<p>
The <code>make*.sh</code> files generate a lot of files that can easily
be regenerated and that are normally removed from the chapter
directories. The script <code>sh ../clean.sh</code> can be run in any
chapter directory to clean up redundant files.

<h2 id="___sec16">Automatic spell checking </h2>

<p>
The <code>make.sh</code> first runs a spell check using <code>doconce spellcheck</code>.
The first time you run this command there will be many &quot;misspellings&quot;
because of unregistered (scientific) words in the dictionary and maybe
also because some words are actually misspelled. Invoke the
<code>misspellings.txt&nbsp;</code> file to see a list of all misspellings. Correct
mistakes in the original documents and run the <code>make.sh</code> script again.
When <code>misspellings.txt&nbsp;</code> at some point contains acceptable words only,
you update the dictionary by

<p>

<!-- code=bash (!bc shpro) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">cp new_dictionary.txt~ .dict4spell.txt
</pre></div>
<p>
Make sure <code>.dict4spell.txt</code> is version controlled by Git.
The <code>make.sh</code> script will not proceed with compilation of the documents
before the spell check is run without errors.

<p>
Finding misspellings can sometimes be a challenge. For a document named
<code>mydoc.do.txt</code>, the spell check is carried out on a stripped version,
named <code>tmp_stripped_mydoc.do.txt</code>. Look into this file for misspellings
that are not obvious. Strange misspellings such as <code>APlu</code> or similar
usually arise from missing dollar sign around mathematical formulas.
Formulas are stripped away in <code>tmp_stripped_mydoc.do.txt</code>, but if a
dollar sign is missing, mathematical formulas become words subject
to spell checking. To find the relevant file containing
a particular misspelling listed in <code>misspellings.txt&nbsp;</code>, you may look
into the file-wise list of misspellings: the misspellings in <code>mydoc.do.txt</code>
are listed in <code>tmp_misspelled_mydoc.do.txt&nbsp;</code>.

<h2 id="___sec17">Compiling the chapter to HTML </h2>

<p>
There is also a script <code>doc/src/chapters/make_html.sh</code> for making
HTML versions of the chapter. Just call this as

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">Terminal&gt; bash ../make_html.sh main_mychap
</pre></div>
<p>
to make HTML versions of the <code>mychap</code> chapter.

<p>
The current version of <code>make_html.sh</code> creates four types of HTML
layouts and an <code>index.html</code> file with a list of links to these three files:
1) HTML plain Bootstrap style, 2) HTML Bootswatch readable style,
3) plain HTML solarized color style, and 4) Sphinx pyramid style.
(Note that the latter document is a true Sphinx document,
made by <code>doconce format sphinx</code>, and from which one
could make other formats too.)

<p>
It is easy to go into the <code>make_html.sh</code> script and generate other
HTML or Sphinx styles.

<p>
<div class="alert alert-block alert-warning alert-text-normal">
<b>You need to edit the index file!</b>
<p>
The <code>index.html</code> file generated by <code>make_html.sh</code> is made from the
DocOnce source file <code>index_html_files.do.txt</code>. This is a
file utilizing Mako programming
(see 
the document <a href="http://hplgit.github.io/setup4book-doconce/doc/pub/mako" target="_self">Use of Mako to aid book writing</a>).
There is also a similar file, <code>index_files.do.txt</code>, listing all
the published documents in various formats associated with a complete
book projects (to go to <code>doc/pub/index.html</code>).

<p>
The <code>index_html_files.do.txt</code> and <code>index_files.do.txt</code> files rely much
on a Mako dictionary <code>chapters</code>, defined in <code>mako_code.txt</code>. This
dictionary maps nicknames to chapter titles. We can then specify a
nickname and easily get the corresponding full chapter title. For
example, in <code>index_files.do.txt</code> we defined a Mako list <code>published</code>
holding the nicknames of the chapters we want to publish. With a Mako
for loop we can then run through these selected chapters and generate
the corresponding DocOnce lists with all the formats that is offered
for a chapter and its associated slides. This is a nice example on
how a potentially quite large DocOnce document with much repetitive
constructions can be written with very compact code.

<p>
One can imagine that for a large books under constant development with
different states of different chapters, this setup makes it easy to
take chapters in and out of the book. In addition, with Mako variables
in the chapters one can easily defined different state of maturity of
the text. With minor Mako programming in <code>index_files.do.txt</code> and
extension of the <code>make*.sh</code> files, authors can generate the various
states of the book, e.g., a quality controlled version approved for
students and a complete &quot;work-in-progress&quot; version for authors only
with all available text and lots of DocOnce square-bracket comments.

<p>
The <code>index_files.do.txt</code> file gives a table of contents of all documents,
so you will normally compile this manually now and then as

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; doconce format html index_files \ 
          --html_style=bootstrap \ 
          --html_links_in_new_window \ 
	  --html_bootstrap_navbar=off
</pre></div>
<p>
and publish it in <code>doc/pub/index.html</code>.
</div>


<h2 id="___sec18">Compiling the chapter to a notebook </h2>

<p>
Although there is no benefit from interactive computing and visualization
in the present document, we may produce an IPython notebook for the fun of it:

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">Terminal&gt; doconce format ipynb main_rules \ 
          CHAPTER=document BOOK=document APPENDIX=document
</pre></div>

<h2 id="___sec19">About figures when publishing HTML </h2>

<p>
There will be <code>&lt;img src=fig-ch2/fig1.png&gt;</code> type of tags in HTML code
produced by DocOnce, so it is very important to ensure that the
<em>published</em> <code>.html</code> files have access to a subdirectory
<code>fig-ch2</code>. Normally, one needs to copy <code>fig-ch2</code> from the <code>ch2</code>
chapter source directory to some publishing directory that stores all
the files necessary for accessing the entire HTML document on the web.

<h2 id="___sec20">Compiling the book </h2>

<p>
Go to <code>doc/src/book</code> and run <code>make.sh</code> to compile the book. This requires
that <code>book.do.txt</code> performs the right include of chapters, table of
contents, and bibliography.

<p>
There are many other tools in <code>doc/src/book</code> too, e.g., the mentioned
library of handy scripts in <code>scripts.py</code>, and an example on how to
pack all files of the entire book projects for publishing with Springer
(<code>pack_Springer.sh</code>).

<p>
The current book layout created by <code>make.sh</code> makes use of a (now outdated)
Springer T4 style for textbooks (requires the <code>.cls</code> and <code>.sty</code> files in
the <code>book</code> directory). Other Springer styles supported by DocOnce
are Lecture Notes in Computational Science and Engineering (monographs
and proceedings),
Lecture Notes in Computer Science (proceedings), and Undergraduate Texts
in Physics. Other book styles will require some manual work, either
working out a LaTeX preamble for a special style and use that when
compiling <code>book.do.txt</code> or actually extending the DocOnce source code.

<h3 id="___sec21">HTML/Sphinx versions of the book </h3>

<p>
It is easy to make a standard HTML version of the <code>book.do.txt</code>
manuscript, but for large books, Sphinx is usually a better
alternative since it supports navigation, searching, and has an
index. There is a script <code>doc/src/book/make_html.sh</code> that creates a
Sphinx version of the book. Actually, it generates two versions

<ul>
 <li> standard Sphinx <a href="http://hplgit.github.io/setup4book-doconce/doc/pub/sphinx/index.html" target="_self">book</a></li>
 <li> <a href="http://runestoneinteractive.org" target="_self">RunestoneInteractive</a> Sphinx <a href="http://hplgit.github.io/setup4book-doconce/doc/pub/sphinx-runestone/index.html" target="_self">book</a></li>
</ul>

<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._rules-solarized003.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._rules-solarized005.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    
