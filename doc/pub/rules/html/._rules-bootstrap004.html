<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Directory and file structure">
<meta name="keywords" content="figure directory,movie directory,video directory,source code directory,nickname,newcommands,chapter organization,chapter files,figure directory,movie directory,video directory,source code directory,assembly (chapters to book),links to fig/src directories,IPython notebooks,notebooks,Jupyter notebooks,RunestoneInteractive books,sphinx,cross-referencing,generalized references,slides,study guides,IPython notebooks,notebooks,Jupyter notebooks,private repos,mirroring repos,admonitions,interactive code,exercises in DocOnce,quiz,multiple-choice questions,video in DocOnce,embedded video in DocOnce,movie in DocOnce">

<title>Directory and file structure</title>

<!-- Bootstrap style: bootstrap_bluegray -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap/css/bootstrap_bluegray.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/*
in.collapse+a.btn.showdetails:before { content:'Hide details'; }
.collapse+a.btn.showdetails:before { content:'Show details'; }
*/
</style>


<script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css">
<script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
});
</script>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Directory structure ',
               1,
               'sec:rules:dir:struct',
               'sec:rules:dir:struct'),
              (' Newcommands ', 1, None, '___sec1'),
              (' Assembling different pieces to a book ',
               1,
               'setup:rules:book:assembly',
               'setup:rules:book:assembly'),
              (' Organization of a chapter ', 2, None, '___sec3'),
              (' Figures and source code ', 2, None, '___sec4'),
              (' Assembly of chapters to a book ', 2, None, '___sec5'),
              (' Tools ', 1, None, '___sec6'),
              (' Making a new chapter ', 2, None, '___sec7'),
              (' Compiling the chapter ', 2, None, '___sec8'),
              (' PDF ', 3, None, '___sec9'),
              (' HTML ', 3, None, '___sec10'),
              (' IPython notebook ', 3, None, '___sec11'),
              (' Cleaning Files ', 3, None, '___sec12'),
              (' About figures when publishing HTML ', 2, None, '___sec13'),
              (' Compiling the book ', 2, None, '___sec14'),
              (' HTML/Sphinx versions of the book ', 3, None, '___sec15'),
              (' Cross-referencing across chapters ', 1, None, '___sec16'),
              (' Syntax of generalized cross-references ',
               2,
               None,
               '___sec17'),
              (' Study guides and slides ', 1, None, '___sec18'),
              (' Slide directory ', 2, None, '___sec19'),
              (' Generating slides from running text ', 2, None, '___sec20'),
              (' Compiling slides ', 2, None, '___sec21'),
              (' IPython/Jupyter notebooks ', 2, None, '___sec22'),
              (' Writing in private repository while publishing in public ',
               1,
               None,
               '___sec23'),
              (' Special features for teaching material ',
               1,
               None,
               '___sec24'),
              (' Admonitions ', 2, None, '___sec25'),
              (' Simple box ', 2, None, '___sec26'),
              (' Embedded interactive code ', 2, None, '___sec27'),
              (' The `pyoptpro` code environment ', 3, None, '___sec28'),
              (' The `pyscpro` code environment ', 3, None, '___sec29'),
              (' Exercises ', 2, None, '___sec30'),
              (' Quote ', 2, None, '___sec31'),
              (' Quiz ', 2, None, '___sec32'),
              (' What about a video lecture? ', 2, None, '___sec33'),
              (' References ', 1, None, '___sec34')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="rules-bootstrap.html">Directory and file structure</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._rules-bootstrap001.html#sec:rules:dir:struct" style="font-size: 80%;">Directory structure</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap002.html#___sec1" style="font-size: 80%;">Newcommands</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap003.html#setup:rules:book:assembly" style="font-size: 80%;">Assembling different pieces to a book</a></li>
     <!-- navigation toc: --> <li><a href="#___sec6" style="font-size: 80%;">Tools</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap005.html#___sec16" style="font-size: 80%;">Cross-referencing across chapters</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap006.html#___sec18" style="font-size: 80%;">Study guides and slides</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap007.html#___sec23" style="font-size: 80%;">Writing in private repository while publishing in public</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap008.html#___sec24" style="font-size: 80%;">Special features for teaching material</a></li>
     <!-- navigation toc: --> <li><a href="._rules-bootstrap008.html#___sec34" style="font-size: 80%;">References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0004"></a>
<!-- !split -->

<h1 id="___sec6">Tools </h1>

<p>
You can start a new, future, potential book project by simply copying
the directory structure of the <a href="https://github.com/hplgit/setup4book-doconce" target="_self">setup4book-doconce</a> repository on GitHub. Then you can follow
the instructions below to start writing and adapting the structure to
your project's needs.

<h2 id="___sec7">Making a new chapter </h2>

<p>
Under <code>doc/src/chapters</code>
you find the chapters in this &quot;sample book&quot; as well as a script
<code>doc/chapters/mkdir.sh</code> that creates a new directory for you with the
typical files needed for a new chapter. You can either edit existing
chapters, or make a brand new empty chapter by running

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; sh mkdir.sh mychap
</pre></div>
<p>
This command makes
a directory <code>mychap</code> for a new chapter with nickname <code>mychap</code>.
Files from the <code>template</code> directory are used to populate <code>mychap</code>. You get
an empty <code>mychap.do.txt</code> where the text is supposed to go, or this file
can just include a series of smaller <code>.do.txt</code> files, and you get the
wrapper file <code>main_mychap.do.txt</code> such that you can compile this chapter
as a stand-alone document. You also get <code>make.sh</code> which calls <code>../make.sh</code>
with the chapter main document (<code>main_mychap</code>) as argument. Optional
arguments for running <code>doconce format pdflatex</code> can be given to
<code>../make.sh</code> in <code>make.sh</code> if needed (e.g., --encoding=utf8`).

<h2 id="___sec8">Compiling the chapter </h2>

<h3 id="___sec9">PDF </h3>

<p>
To make a stand-alone document of a chapter, by compiling to LaTeX and PDF,
we propose the convention to have a <code>make.sh</code> in each chapter directory.
This <code>make.sh</code> can in most cases just call up a common <code>../make.sh</code>
script,

<p>

<!-- code=bash (!bc shpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">bash -x ../make.sh main_mychap
</pre></div>
<p>
or optionally with some command-line arguments,

<p>

<!-- code=bash (!bc shpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">bash -x ../make.sh main_mychap --encoding<span style="color: #666666">=</span>utf-8
</pre></div>
<p>
The <code>doc/src/chapters/make.sh</code> script is quite general and may be edited
according to your layout preferences of the LaTeX documents.

<p>
The present <code>make.sh</code> script creates two PDF files: one for printing and
one for electronic viewing. The difference is that all URLs in the
version for printing appear as footnotes (and just hyperlinks with
a dark blue color in the electronic version). The two files are
named <code>mychap.pdf</code> and <code>mychap-4print.pdf</code>, respectively, and
copied to <code>doc/pub/mychap/pdf</code> for publishing.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Tip: use tinyurl.com for shortening long URLs.</b>
When compiling a document to LaTeX for <em>printing on paper</em> (<code>--device=paper</code>),
URLs in hyperlinks will appear as footnotes. Very long URLs may then exceed
the line width, or worse, extend beyond the physical paper size.
Replace such long URLs with short forms using <a href="http://tinyurl.com/" target="_self">tinyurl.com</a>.
I recommend tinyurl.com rather than competitors like goo.gl and bit.ly
because
if you have some URL <code>http://tinyurl.com/oul3xhn</code> you can easily
add more to the path, e.g., <code>http://tinyurl.com/oul3xhn/index.html</code>,
and this new URL works (goo.gl and bit.ly do not allow such extensions).

<p>
In particular, you can define the tinyurl.com URL as a Mako variable
(see <code>doc/mako_code.txt</code> for example) and use it as a quick and logical
name in the text for the URL and extend its path as appropriate. For example,
I always have a Mako variable for the URL of the repo directory for
the software associated with a chapter and can then easily add
<code>/myprog.py</code> to the variable to create a link to the file at GitHub.
Readers can then just click to read or download the file.
</div>


<p>
<b>Remark about LaTeX typesetting of computer code.</b>
The suggested <code>make.sh</code> file
applies the <code>--latex_code_style=</code> option to <code>doconce format</code>
for specifying the typesetting of blocks of computer code in LaTeX.
Originally, DocOnce applied the <code>ptex2tex</code> program to select such
typesetting, but the new method is more flexible and simpler (in that
it gives cleaner LaTeX code). (With <code>ptex2tex</code> one would need a common
configuration file <code>doc/chapters/.ptex2tex.cfg</code> to be copied by
<code>doc/chapters/make.sh</code> to the chapter directory prior to running
`ptex2tex.)

<h3 id="___sec10">HTML </h3>

<p>
There is also a script <code>doc/src/chapters/make_html.sh</code> for making
HTML versions of the chapter. Just call this as

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; bash ../make_html.sh main_mychap
</pre></div>
<p>
to make HTML versions of the <code>mychap</code> chapter.

<p>
The current version of <code>make_html.sh</code> creates four types of HTML
layouts and an <code>index.html</code> file with a list of links to these three files:
1) HTML plain Bootstrap style, 2) HTML Bootswatch readable style,
3) plain HTML solarized color style, and 4) Sphinx pyramid style.
(Note that the latter document is a true Sphinx document,
made by <code>doconce format sphinx</code>, and from which one
could make other formats too.)

<p>
It is easy to go into the <code>make_html.sh</code> script and generate other
HTML or Sphinx styles.

<p>
<div class="alert alert-block alert-danger alert-text-normal"><b>You need to edit the index file!</b>
The <code>index.html</code> file generated by <code>make_html.sh</code> is made from the
DocOnce source file <code>index_html_files.do.txt</code>. This is a
file utilizing Mako programming
(see 
the document <a href="http://hplgit.github.io/setup4book-doconce/doc/pub/mako" target="_self">Use of Mako to aid book writing</a>.
There is also a similar file, <code>index_files.do.txt</code>, listing all
the published documents in various formats associated with a complete
book projects (to go to <code>doc/pub/index.html</code>).

<p>
In the <code>index_html_files.do.txt</code> file, we define a Mako dictionary
<code>chapters</code> mapping nicknames to chapter titles. This dict makes it easy
to compile <code>index_html_files.do.txt</code> with a Mako variable <code>CHAPTER</code>
set to the chapter nickname and get a tailored <code>index.html</code> file
for the HTML versions of that chapter. Similarly,
<code>index_files.do.txt</code> also has a <code>chapters</code> dict and an associated
<code>published</code> list with all the nicknames of the chapters that we want
to list in the overview of the entire book project (all sufficiently
finished chapters).

<p>
The <code>index_files.do.txt</code> file gives a table of contents of all documents,
so you will normally compile this manually now and then as

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%">Terminal&gt; doconce format html index_files --html_style=bootstrap \ 
          --html_links_in_new_window --html_bootstrap_navbar=off
</pre></div>
<p>
and publish it in <code>doc/pub/index.html</code>.
</div>


<h3 id="___sec11">IPython notebook </h3>

<p>
Although there is no benefit from interactive computing and visualization
in the present document, we may produce an IPython notebook for the fun of it:

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; doconce format ipynb main_rules \ 
          CHAPTER=document BOOK=document APPENDIX=document
</pre></div>

<h3 id="___sec12">Cleaning Files </h3>

<p>
The <code>make*.sh</code> files generate a lot of files that can easily
be regenerated and that are normally removed from the chapter
directories. The script <code>sh ../clean.sh</code> can be run in any
chapter directory to clean up redundant files.

<h2 id="___sec13">About figures when publishing HTML </h2>

<p>
There will be <code>&lt;img src=fig-ch2/fig1.png&gt;</code> type of tags in HTML code
produced by DocOnce, so it is very important to ensure that the
<em>published</em> <code>.html</code> files have access to a subdirectory
<code>fig-ch2</code>. Normally, one needs to copy <code>fig-ch2</code> from the <code>ch2</code>
chapter source directory to some publishing directory that stores all
the files necessary for accessing the entire HTML document on the web.

<h2 id="___sec14">Compiling the book </h2>

<p>
Go to <code>doc/src/book</code> and run <code>make.sh</code> to compile the book. This requires
that <code>book.do.txt</code> performs the right include of chapters, table of
contents, and bibliography.

<p>
There are many other tools in <code>doc/src/book</code> too, e.g., the mentioned
library of handy scripts in <code>scripts.py</code>, and an example on how to
pack all files of the entire book projects for publishing with Springer
(<code>pack_Springer.sh</code>).

<p>
The current book layout created by <code>make.sh</code> makes use of a (now outdated)
Springer T2 style for textbooks (requires the <code>.cls</code> and <code>.sty</code> files in
the <code>book</code> directory). Other Springer styles supported by DocOnce
are Lecture Notes in Computational Science and Engineering (monographs
and proceedings),
Lecture Notes in Computer Science (proceedings), and Undergraduate Texts
in Physics. Other book styles will require some manual work, either
working out a LaTeX preamble for a special style and use that when
compiling <code>book.do.txt</code> or actually extending the DocOnce source code.

<h3 id="___sec15">HTML/Sphinx versions of the book </h3>

<p>
It is easy to make a standard HTML version of the <code>book.do.txt</code>
manuscript, but for large books, Sphinx is usually a better
alternative since it supports navigation, searching, and has an
index. There is a script <code>doc/src/book/make_html.sh</code> that creates a
Sphinx version of the book. Actually, it generates two versions

<ul>
 <li> standard Sphinx <a href="http://hplgit.github.io/setup4book-doconce/doc/pub/sphinx/index.html" target="_self">book</a></li>
 <li> <a href="http://runestoneinteractive.org" target="_self">RunestoneInteractive</a> Sphinx <a href="http://hplgit.github.io/setup4book-doconce/doc/pub/sphinx-runestone/index.html" target="_self">book</a></li>
</ul>

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._rules-bootstrap003.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._rules-bootstrap005.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    
