

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tools</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="How to Use DocOnce to Write Books" href="index.html" />
    <link rel="next" title="Cross-referencing across chapters" href="._book007.html" />
    <link rel="prev" title="Assembling different pieces to a book" href="._book005.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book007.html" title="Cross-referencing across chapters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book005.html" title="Assembling different pieces to a book"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">How to Use DocOnce to Write Books</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tools">
<h1>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h1>
<p>You can start a new, future, potential book project by simply copying
the directory structure of the <a class="reference external" href="https://github.com/hplgit/setup4book-doconce">setup4book-doconce</a> repository on GitHub. Then you can follow
the instructions below to start writing and adapting the structure to
your project&#8217;s needs.</p>
<div class="section" id="making-a-new-chapter">
<h2>Making a new chapter<a class="headerlink" href="#making-a-new-chapter" title="Permalink to this headline">¶</a></h2>
<p id="index-0">Under <tt class="docutils literal"><span class="pre">doc/src/chapters</span></tt>
you find the chapters in this &#8220;sample book&#8221; as well as a script
<tt class="docutils literal"><span class="pre">doc/chapters/mkdir.sh</span></tt> that creates a new directory for you with the
typical files needed for a new chapter. You can either edit existing
chapters, or make a brand new empty chapter by running</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; sh mkdir.sh mychap
</pre></div>
</div>
<p>This command makes
a directory <tt class="docutils literal"><span class="pre">mychap</span></tt> for a new chapter with nickname <tt class="docutils literal"><span class="pre">mychap</span></tt>.
Files from the <tt class="docutils literal"><span class="pre">template</span></tt> directory are used to populate <tt class="docutils literal"><span class="pre">mychap</span></tt>. You get
an empty <tt class="docutils literal"><span class="pre">mychap.do.txt</span></tt> where the text is supposed to go, or this file
can just include a series of smaller <tt class="docutils literal"><span class="pre">.do.txt</span></tt> files, and you get the
wrapper file <tt class="docutils literal"><span class="pre">main_mychap.do.txt</span></tt> such that you can compile this chapter
as a stand-alone document. You also get <tt class="docutils literal"><span class="pre">make.sh</span></tt> which calls <tt class="docutils literal"><span class="pre">../make.sh</span></tt>
with the chapter main document (<tt class="docutils literal"><span class="pre">main_mychap</span></tt>) as argument. Optional
arguments for running <tt class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">pdflatex</span></tt> can be given to
<tt class="docutils literal"><span class="pre">../make.sh</span></tt> in <tt class="docutils literal"><span class="pre">make.sh</span></tt> if needed (e.g., &#8211;encoding=utf8`).</p>
</div>
<div class="section" id="compiling-the-chapter">
<h2>Compiling the chapter<a class="headerlink" href="#compiling-the-chapter" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pdf">
<span id="index-1"></span><h3>PDF<a class="headerlink" href="#pdf" title="Permalink to this headline">¶</a></h3>
<p>To make a stand-alone document of a chapter, by compiling to LaTeX and PDF,
we propose the convention to have a <tt class="docutils literal"><span class="pre">make.sh</span></tt> in each chapter directory.
This <tt class="docutils literal"><span class="pre">make.sh</span></tt> can in most cases just call up a common <tt class="docutils literal"><span class="pre">../make.sh</span></tt>
script,</p>
<div class="highlight-bash"><div class="highlight"><pre>bash -x ../make.sh main_mychap
</pre></div>
</div>
<p>or optionally with some command-line arguments,</p>
<div class="highlight-bash"><div class="highlight"><pre>bash -x ../make.sh main_mychap --encoding<span class="o">=</span>utf-8
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">doc/src/chapters/make.sh</span></tt> script is quite general and may be edited
according to your layout preferences of the LaTeX documents.</p>
<p>The present <tt class="docutils literal"><span class="pre">make.sh</span></tt> script creates two PDF files: one for printing and
one for electronic viewing. The difference is that all URLs in the
version for printing appear as footnotes (and just hyperlinks with
a dark blue color in the electronic version). The two files are
named <tt class="docutils literal"><span class="pre">mychap.pdf</span></tt> and <tt class="docutils literal"><span class="pre">mychap-4print.pdf</span></tt>, respectively, and
copied to <tt class="docutils literal"><span class="pre">doc/pub/mychap/pdf</span></tt> for publishing.</p>
<div class="admonition-tip-use-tinyurl-com-for-shortening-long-urls admonition">
<p class="first admonition-title">Tip: use tinyurl.com for shortening long URLs</p>
<p>When compiling a document to LaTeX for <em>printing on paper</em> (<tt class="docutils literal"><span class="pre">--device=paper</span></tt>),
URLs in hyperlinks will appear as footnotes. Very long URLs may then exceed
the line width, or worse, extend beyond the physical paper size.
Replace such long URLs with short forms using <a class="reference external" href="http://tinyurl.com/">tinyurl.com</a>.
I recommend tinyurl.com rather than competitors like goo.gl and bit.ly
because
if you have some URL <tt class="docutils literal"><span class="pre">http://tinyurl.com/oul3xhn</span></tt> you can easily
add more to the path, e.g., <tt class="docutils literal"><span class="pre">http://tinyurl.com/oul3xhn/index.html</span></tt>,
and this new URL works (goo.gl and bit.ly do not allow such extensions).</p>
<p class="last">In particular, you can define the tinyurl.com URL as a Mako variable
(see <tt class="docutils literal"><span class="pre">doc/mako_code.txt</span></tt> for example) and use it as a quick and logical
name in the text for the URL and extend its path as appropriate. For example,
I always have a Mako variable for the URL of the repo directory for
the software associated with a chapter and can then easily add
<tt class="docutils literal"><span class="pre">/myprog.py</span></tt> to the variable to create a link to the file at GitHub.
Readers can then just click to read or download the file.</p>
</div>
<p><strong>Remark about LaTeX typesetting of computer code.</strong>
The suggested <tt class="docutils literal"><span class="pre">make.sh</span></tt> file
applies the <tt class="docutils literal"><span class="pre">--latex_code_style=</span></tt> option to <tt class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></tt>
for specifying the typesetting of blocks of computer code in LaTeX.
Originally, DocOnce applied the <tt class="docutils literal"><span class="pre">ptex2tex</span></tt> program to select such
typesetting, but the new method is more flexible and simpler (in that
it gives cleaner LaTeX code). (With <tt class="docutils literal"><span class="pre">ptex2tex</span></tt> one would need a common
configuration file <tt class="docutils literal"><span class="pre">doc/chapters/.ptex2tex.cfg</span></tt> to be copied by
<tt class="docutils literal"><span class="pre">doc/chapters/make.sh</span></tt> to the chapter directory prior to running
<a href="#id1"><span class="problematic" id="id2">`</span></a>ptex2tex.)</p>
</div>
<div class="section" id="html">
<span id="index-2"></span><h3>HTML<a class="headerlink" href="#html" title="Permalink to this headline">¶</a></h3>
<p>There is also a script <tt class="docutils literal"><span class="pre">doc/src/chapters/make_html.sh</span></tt> for making
HTML versions of the chapter. Just call this as</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; bash ../make_html.sh main_mychap
</pre></div>
</div>
<p>to make HTML versions of the <tt class="docutils literal"><span class="pre">mychap</span></tt> chapter.</p>
<p>The current version of <tt class="docutils literal"><span class="pre">make_html.sh</span></tt> creates four types of HTML
layouts and an <tt class="docutils literal"><span class="pre">index.html</span></tt> file with a list of links to these three files:
1) HTML plain Bootstrap style, 2) HTML Bootswatch readable style,
3) plain HTML solarized color style, and 4) Sphinx pyramid style.
(Note that the latter document is a true Sphinx document,
made by <tt class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">sphinx</span></tt>, and from which one
could make other formats too.)</p>
<p>It is easy to go into the <tt class="docutils literal"><span class="pre">make_html.sh</span></tt> script and generate other
HTML or Sphinx styles.</p>
<div class="admonition-you-need-to-edit-the-index-file admonition">
<p class="first admonition-title">You need to edit the index file</p>
<p>The <tt class="docutils literal"><span class="pre">index.html</span></tt> file generated by <tt class="docutils literal"><span class="pre">make_html.sh</span></tt> is made from the
DocOnce source file <tt class="docutils literal"><span class="pre">index_html_files.do.txt</span></tt>. This is a
file utilizing Mako programming
(see appendix <a class="reference internal" href="._book011.html#ch-mako"><em>Appendix: Use of Mako to aid book writing</em></a>).
There is also a similar file, <tt class="docutils literal"><span class="pre">index_files.do.txt</span></tt>, listing all
the published documents in various formats associated with a complete
book projects (to go to <tt class="docutils literal"><span class="pre">doc/pub/index.html</span></tt>).</p>
<p>The <tt class="docutils literal"><span class="pre">index_html_files.do.txt</span></tt> and <tt class="docutils literal"><span class="pre">index_files.do.txt</span></tt> files rely much
on a Mako dictionary <tt class="docutils literal"><span class="pre">chapters</span></tt>, defined in <tt class="docutils literal"><span class="pre">mako_code.txt</span></tt>. This
dictionary maps nicknames to chapter titles. We can then specify a
nickname and easily get the corresponding full chapter title. For
example, in <tt class="docutils literal"><span class="pre">index_files.do.txt</span></tt> we defined a Mako list <tt class="docutils literal"><span class="pre">published</span></tt>
holding the nicknames of the chapters we want to publish. With a Mako
for loop we can then run through these selected chapters and generate
the corresponding DocOnce lists with all the formats that is offered
for a chapter and its associated slides. This is a nice example on
how a potentially quite large DocOnce document with much repetitive
constructions can be written with very compact code.</p>
<p>One can imagine that for a large books under constant development with
different states of different chapters, this setup makes it easy to
take chapters in and out of the book. In addition, with Mako variables
in the chapters one can easily defined different state of maturity of
the text. With minor Mako programming in <tt class="docutils literal"><span class="pre">index_files.do.txt</span></tt> and
extension of the <tt class="docutils literal"><span class="pre">make*.sh</span></tt> files, authors can generate the various
states of the book, e.g., a quality controlled version approved for
students and a complete &#8220;work-in-progress&#8221; version for authors only
with all available text and lots of DocOnce square-bracket comments.</p>
<p>The <tt class="docutils literal"><span class="pre">index_files.do.txt</span></tt> file gives a table of contents of all documents,
so you will normally compile this manually now and then as</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format html index_files --html_style=bootstrap \
          --html_links_in_new_window --html_bootstrap_navbar=off
</pre></div>
</div>
<p class="last">and publish it in <tt class="docutils literal"><span class="pre">doc/pub/index.html</span></tt>.</p>
</div>
<span class="target" id="index-3"></span><span class="target" id="index-4"></span></div>
<div class="section" id="ipython-notebook">
<span id="index-5"></span><h3>IPython notebook<a class="headerlink" href="#ipython-notebook" title="Permalink to this headline">¶</a></h3>
<p>Although there is no benefit from interactive computing and visualization
in the present document, we may produce an IPython notebook for the fun of it:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format ipynb main_rules \
          CHAPTER=document BOOK=document APPENDIX=document
</pre></div>
</div>
</div>
<div class="section" id="cleaning-files">
<span id="index-6"></span><h3>Cleaning Files<a class="headerlink" href="#cleaning-files" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">make*.sh</span></tt> files generate a lot of files that can easily
be regenerated and that are normally removed from the chapter
directories. The script <tt class="docutils literal"><span class="pre">sh</span> <span class="pre">../clean.sh</span></tt> can be run in any
chapter directory to clean up redundant files.</p>
</div>
</div>
<div class="section" id="about-figures-when-publishing-html">
<h2>About figures when publishing HTML<a class="headerlink" href="#about-figures-when-publishing-html" title="Permalink to this headline">¶</a></h2>
<p>There will be <tt class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=fig-ch2/fig1.png&gt;</span></tt> type of tags in HTML code
produced by DocOnce, so it is very important to ensure that the
<em>published</em> <tt class="docutils literal"><span class="pre">.html</span></tt> files have access to a subdirectory
<tt class="docutils literal"><span class="pre">fig-ch2</span></tt>. Normally, one needs to copy <tt class="docutils literal"><span class="pre">fig-ch2</span></tt> from the <tt class="docutils literal"><span class="pre">ch2</span></tt>
chapter source directory to some publishing directory that stores all
the files necessary for accessing the entire HTML document on the web.</p>
</div>
<div class="section" id="compiling-the-book">
<h2>Compiling the book<a class="headerlink" href="#compiling-the-book" title="Permalink to this headline">¶</a></h2>
<p>Go to <tt class="docutils literal"><span class="pre">doc/src/book</span></tt> and run <tt class="docutils literal"><span class="pre">make.sh</span></tt> to compile the book. This requires
that <tt class="docutils literal"><span class="pre">book.do.txt</span></tt> performs the right include of chapters, table of
contents, and bibliography.</p>
<p>There are many other tools in <tt class="docutils literal"><span class="pre">doc/src/book</span></tt> too, e.g., the mentioned
library of handy scripts in <tt class="docutils literal"><span class="pre">scripts.py</span></tt>, and an example on how to
pack all files of the entire book projects for publishing with Springer
(<tt class="docutils literal"><span class="pre">pack_Springer.sh</span></tt>).</p>
<p>The current book layout created by <tt class="docutils literal"><span class="pre">make.sh</span></tt> makes use of a (now outdated)
Springer T2 style for textbooks (requires the <tt class="docutils literal"><span class="pre">.cls</span></tt> and <tt class="docutils literal"><span class="pre">.sty</span></tt> files in
the <tt class="docutils literal"><span class="pre">book</span></tt> directory). Other Springer styles supported by DocOnce
are Lecture Notes in Computational Science and Engineering (monographs
and proceedings),
Lecture Notes in Computer Science (proceedings), and Undergraduate Texts
in Physics. Other book styles will require some manual work, either
working out a LaTeX preamble for a special style and use that when
compiling <tt class="docutils literal"><span class="pre">book.do.txt</span></tt> or actually extending the DocOnce source code.</p>
<div class="section" id="html-sphinx-versions-of-the-book">
<h3>HTML/Sphinx versions of the book<a class="headerlink" href="#html-sphinx-versions-of-the-book" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-7"></span><p id="index-8">It is easy to make a standard HTML version of the <tt class="docutils literal"><span class="pre">book.do.txt</span></tt>
manuscript, but for large books, Sphinx is usually a better
alternative since it supports navigation, searching, and has an
index. There is a script <tt class="docutils literal"><span class="pre">doc/src/book/make_html.sh</span></tt> that creates a
Sphinx version of the book. Actually, it generates two versions</p>
<blockquote>
<div><ul class="simple">
<li>standard Sphinx <a class="reference external" href="http://hplgit.github.io/setup4book-doconce/doc/pub/sphinx/index.html">book</a></li>
<li><a class="reference external" href="http://runestoneinteractive.org">RunestoneInteractive</a> Sphinx <a class="reference external" href="http://hplgit.github.io/setup4book-doconce/doc/pub/sphinx-runestone/index.html">book</a></li>
</ul>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://www.mn.uio.no/english/" title="Go to University of Oslo">
              <img class="logo" src="https://raw.githubusercontent.com/CINPLA/logo/master/brain/cinpla_logo_transparent.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tools</a><ul>
<li><a class="reference internal" href="#making-a-new-chapter">Making a new chapter</a></li>
<li><a class="reference internal" href="#compiling-the-chapter">Compiling the chapter</a><ul>
<li><a class="reference internal" href="#pdf">PDF</a></li>
<li><a class="reference internal" href="#html">HTML</a></li>
<li><a class="reference internal" href="#ipython-notebook">IPython notebook</a></li>
<li><a class="reference internal" href="#cleaning-files">Cleaning Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-figures-when-publishing-html">About figures when publishing HTML</a></li>
<li><a class="reference internal" href="#compiling-the-book">Compiling the book</a><ul>
<li><a class="reference internal" href="#html-sphinx-versions-of-the-book">HTML/Sphinx versions of the book</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book005.html"
                        title="previous chapter">Assembling different pieces to a book</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book007.html"
                        title="next chapter">Cross-referencing across chapters</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._book006.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book007.html" title="Cross-referencing across chapters"
             >next</a> |</li>
        <li class="right" >
          <a href="._book005.html" title="Assembling different pieces to a book"
             >previous</a> |</li>
        <li><a href="index.html">How to Use DocOnce to Write Books</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
  <a href="http://www.mn.uio.no/english/"><img src="_static/uio_banner.png" width="20%"><a>
  </div>
</div>

  </body>
</html>